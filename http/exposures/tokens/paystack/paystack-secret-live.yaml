id: paystack-secret-live

info:
  name: Paystack Secret/Live Key - Exposure
  author: Lloydcoder
  severity: info
  description: |
    Detected exposed Paystack secret keys (test or live) found in application source code, configuration files, or client-side assets.
  reference:
    - https://support.paystack.com/en/articles/2123458
  tags: exposure,token,paystack,fintech,tinlance

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "sk_(live|test)_[0-9a-zA-Z]{50,}"

      - type: word
        words:
          - "paystack"
          - "secret_key"
          - "sk_live"
          - "sk_test"
        condition: or
        case-insensitive: true
