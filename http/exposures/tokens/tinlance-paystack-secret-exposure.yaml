id: tinlance-paystack-secret-exposure

info:
  name: Paystack Secret/Live Key - Exposure
  author: Lloydcoder
  severity: high
  description: |
    Detects exposed Paystack secret keys (test or live) commonly used by Nigerian startups and fintech companies.
  classification:
    cvss-score: 9.8
  tags: exposure,token,paystack,fintech,tinlance

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "sk_(live|test)_[0-9a-zA-Z]{50,}"

      - type: word
        words:
          - "paystack"
          - "secret_key"
          - "sk_live"
          - "sk_test"
        condition: or
        case-insensitive: true
